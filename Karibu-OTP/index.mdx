# Karibu-OTP

---
title: "Karibu OTP — API Reference"
description: "API reference and concise guide for One-Time Password (OTP) operations."
---

The Karibu OTP API lets developers request, verify, resend, invalidate and check the status of one-time passwords. All endpoints require the X-API-Key header to authenticate a developer app within a workspace.

Create an OTP with POST /v1/otp/request by providing the recipient phone (E.164), developer_app_id and optional settings such as otp_length, minutes_to_expire, delivery_method ("sms" or "call") and message_template. Verify with POST /v1/otp/verify (request_id or phone + code), resend with POST /v1/otp/resend, invalidate with POST /v1/otp/invalidate and check status with GET /v1/otp/status. Prefer "call" in regions where SMS routing is unreliable.

Request example:
```json
{
  "phone_number": "+255712345678",
  "developer_app_id": "briq_abc123xyz789",
  "delivery_method": "sms",
  "otp_length": 6,
  "minutes_to_expire": 5,
  "message_template": "Your verification code is {code}"
}
```

Standard success response:
```json
{
  "success": true,
  "message": "string",
  "data": {},
  "status_code": 200
}
```

Interactive playground pages for endpoints are available under the endpoints/ folder if you want try-it-now examples. For SDK samples request a specific language and examples will be added.
Standard success response format:
```json
{
  "success": true,
  "message": "string",
  "data": {},
  "status_code": 200
}
```

For errors the API returns a clear error message and appropriate HTTP status code. Keep OTP lifetimes short, limit verification attempts, and log delivery and verification events for monitoring and troubleshooting. If you need SDK examples or language samples, request a specific language and examples will be added.
* Limit validation attempts to prevent brute-force.  
* Rate-limit request/resend calls per recipient.  
* Use numeric codes for SMS; voice may support longer alphanumeric tokens.

## Interactive playgrounds

The interactive API playground pages for OTP endpoints live under the `endpoints/` folder.

- [Request OTP](/Karibu-OTP/endpoints/request-otp)
- [Validate OTP](/Karibu-OTP/endpoints/validate-otp)
- [Resend OTP](/Karibu-OTP/endpoints/resend-otp)

---

### Request OTP

Endpoint  
POST /v1/otp/request

Headers
- `X-API-Key` (required)

Request body (application/json)
```json
{
  "recipient": "+255712345678",
  "channel": "sms",            // "sms" or "call"
  "length": 6,
  "minutes_to_expire": 5,
  "message_template": "Your verification code is {code}"
}
```

Alternate request/resend payload example:
```json
{
  "phone_number":"+255672204508",
  "app_key": "briq_65q2g35t7ty6q1sb",
  "sender_id": "BRIQ",
  "otp_length": 6,
  "minutes_to_expire": 10,
  "delivery_method": "sms"
}
```

Response — 201 Created (example)
```json
{
  "success": true,
  "message": "OTP Code sent successfully.",
  "data": {
    "expires_at": "2025-08-23T00:37:03.502607"
  },
  "status_code": 200
}
```

--- 

### Validate OTP

Endpoint  
POST /v1/otp/validate

Headers
- `X-API-Key` (required)

Request body (application/json)
```json
{
  "request_id": "otpreq_123456",
  "code": "123456"
}
```

Response — 200 OK (example)
```json
{
  "success": true,
  "message": "OTP verified successfully.",
  "data": {
    "verified_at": "2025-08-23T00:28:15.567264"
  },
  "status_code": 200
}
```

Response — 400 / 422
```json
{ "valid": false, "detail":[{ "msg":"Invalid or expired code" }] }
```

---

### Resend OTP

Endpoint  
POST /v1/otp/resend

Headers
- `X-API-Key` (required)

Request body (application/json)
```json
{
  "request_id": "otpreq_123456",
  "channel": "sms"         // optional override, "sms" or "voice"
}
```

You can also use the same alternate payload format (phone_number + app_key + sender_id + delivery_method) when implementing a resend flow in your application.

Response — 200 OK
```json
{
  "request_id": "otpreq_123456",
  "resent": true,
  "sent_at": "2019-08-24T14:16:22Z"
}
```

Response — 429 Too Many Requests / 422
```json
{ "detail":[{ "msg":"Rate limit exceeded or invalid request_id" }] }
```

---

### Notes and best practices

- Channels: use "sms" for text delivery or "voice" for automated call delivery.  
- Keep OTP lifetime short and limit validation attempts.  
- Store request_id for matching validation attempts and for troubleshooting.  
- Log delivery and validation events for audit and debugging.

If you need SDK examples or additional language code samples, request the specific language and code samples will be added.
